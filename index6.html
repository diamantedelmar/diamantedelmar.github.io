<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Diamante del Mar Phaedra</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .section-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #f7fafc; /* light gray */
            z-index: 50;
            overflow-y: auto;
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }
        .section-screen.active {
            transform: translateX(0);
        }
        .card {
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .grid-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1rem;
            border-radius: 1rem;
            background: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 1px solid rgba(226, 232, 240, 1);
            transition: all 0.2s ease-in-out;
        }
        .grid-button:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .section-header {
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 10;
        }
        .prose-custom p, .prose-custom li {
            color: #4A5568;
        }
        .prose-custom h3 {
            color: #2D3748;
            font-weight: 600;
        }
        .btn-primary {
            background-color: #4a90e2; /* Blue */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out;
        }
        .btn-primary:hover {
            background-color: #357ABD;
        }
        /* Loading Spinner */
        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid #FFF;
            border-bottom-color: #4a90e2;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Chat UI styles */
        .chat-bubble {
            max-width: 80%;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            margin-bottom: 0.5rem;
            word-wrap: break-word;
        }
        .chat-bubble.user {
            background-color: #4a90e2;
            color: white;
            border-bottom-right-radius: 0.25rem;
            align-self: flex-end;
        }
        .chat-bubble.ai {
            background-color: #e2e8f0;
            color: #2d3748;
            border-bottom-left-radius: 0.25rem;
            align-self: flex-start;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div id="app" class="max-w-md mx-auto min-h-screen bg-gray-100">
        
        <div id="home-screen">
            <header class="relative">
                <img src="https://images.unsplash.com/photo-1590530325942-15f23e42b267?q=80&w=800&auto=format&fit=crop" 
                     onerror="this.onerror=null;this.src='https://diamantedelmar.github.io/phaedra.png';" 
                     alt="Phaedra" class="w-full h-60 object-cover">
                <div class="absolute bottom-0 left-0 w-full h-24 bg-gradient-to-t from-gray-100 to-transparent"></div>
            </header>
            <div class="p-4 -mt-10">
                 <div class="text-center mb-6 bg-white/80 backdrop-blur-sm p-4 rounded-xl shadow-lg">
                    <h1 class="text-3xl font-bold text-gray-800">Welcome Book</h1>
                </div>
                <main>
                    <div class="grid grid-cols-3 gap-4">
                        <!-- AI Features -->
                        <button onclick="showSection('ai-concierge-section')" class="grid-button col-span-1">
                            <i data-lucide="sparkles" class="w-10 h-10 text-purple-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">AI Concierge</span>
                        </button>
                        <button onclick="showSection('ai-itinerary-section')" class="grid-button col-span-1">
                            <i data-lucide="calendar-check" class="w-10 h-10 text-green-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">AI Itinerary</span>
                        </button>
                         <button onclick="showSection('ai-recipes-section')" class="grid-button col-span-1">
                            <i data-lucide="chef-hat" class="w-10 h-10 text-orange-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">AI Recipes</span>
                        </button>
                        
                        <!-- Original Buttons -->
                        <button onclick="showSection('welcome-section')" class="grid-button">
                            <i data-lucide="sun" class="w-8 h-8 text-blue-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">Welcome</span>
                        </button>
                        <button onclick="showSection('essentials-section')" class="grid-button">
                            <i data-lucide="key-round" class="w-8 h-8 text-blue-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">Apartment</span>
                        </button>
                        <button onclick="showSection('guide-section')" class="grid-button">
                            <i data-lucide="map" class="w-8 h-8 text-blue-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">Island Guide</span>
                        </button>
                        <button onclick="showSection('events-section')" class="grid-button">
                            <i data-lucide="calendar-days" class="w-8 h-8 text-blue-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">Events</span>
                        </button>
                        <button onclick="showSection('local-products-section')" class="grid-button">
                            <i data-lucide="shopping-bag" class="w-8 h-8 text-blue-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">Local Goods</span>
                        </button>
                        <button onclick="showSection('island-hopping-section')" class="grid-button">
                            <i data-lucide="sailboat" class="w-8 h-8 text-blue-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">Island Hop</span>
                        </button>
                        <button onclick="showSection('transport-section')" class="grid-button">
                            <i data-lucide="bus" class="w-8 h-8 text-blue-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">Transport</span>
                        </button>
                        <button onclick="showSection('important-section')" class="grid-button">
                            <i data-lucide="siren" class="w-8 h-8 text-blue-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">Important</span>
                        </button>
                        <button onclick="showSection('departure-section')" class="grid-button">
                            <i data-lucide="log-out" class="w-8 h-8 text-blue-500 mb-2"></i>
                            <span class="font-semibold text-gray-700 text-sm">Departure</span>
                        </button>
                    </div>
                </main>
            </div>
        </div>

        <!-- AI CONCIERGE SECTION -->
        <div id="ai-concierge-section" class="section-screen flex flex-col h-full">
            <header class="section-header p-4 flex items-center shadow-md">
                <button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200">
                    <i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i>
                </button>
                <h2 class="text-xl font-bold text-gray-800 mx-auto">AI Concierge</h2>
            </header>
            <div class="p-4 flex-grow overflow-y-auto flex flex-col" id="chat-container">
                <!-- Chat messages will be appended here -->
                <div class="chat-bubble ai">Hello! How can I help you today? Ask me about the apartment, the island, or anything else.</div>
            </div>
            <div class="p-4 bg-white border-t">
                <div class="mb-2">
                    <label class="text-sm font-medium text-gray-600">Knowledge Source:</label>
                    <div class="flex items-center space-x-4 mt-1">
                        <label class="flex items-center">
                            <input type="radio" name="knowledgeSource" value="welcomeBook" class="form-radio text-blue-500" checked>
                            <span class="ml-2 text-sm text-gray-700">Welcome Book</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="knowledgeSource" value="webSearch" class="form-radio text-blue-500">
                            <span class="ml-2 text-sm text-gray-700">Web Search</span>
                        </label>
                    </div>
                </div>
                <div class="flex items-center space-x-2">
                    <input type="text" id="chat-input" class="flex-grow border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Type your question...">
                    <button onclick="handleChatSubmit()" class="bg-blue-500 text-white p-2 rounded-full hover:bg-blue-600 focus:outline-none">
                        <i data-lucide="send" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- AI ITINERARY SECTION -->
        <div id="ai-itinerary-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md">
                <button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200">
                    <i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i>
                </button>
                <h2 class="text-xl font-bold text-gray-800 mx-auto">AI Itinerary Planner</h2>
            </header>
            <div class="p-6 space-y-4">
                <div class="card p-4">
                    <h3 class="font-semibold text-lg mb-2">Create Your Perfect Trip</h3>
                    <div>
                        <label for="stay-days" class="block text-sm font-medium text-gray-700">How many days are you staying?</label>
                        <input type="number" id="stay-days" value="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2">
                    </div>
                    <div class="mt-4">
                        <label for="interests" class="block text-sm font-medium text-gray-700">What are your interests?</label>
                        <textarea id="interests" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2" placeholder="e.g., beaches, history, food, hiking, nightlife, relaxation..."></textarea>
                    </div>
                    <button onclick="generateItinerary()" class="mt-4 w-full btn-primary">Generate Itinerary</button>
                </div>
                <div id="itinerary-output" class="prose-custom space-y-4">
                    <!-- AI-generated itinerary will appear here -->
                    <div class="text-center p-4 text-gray-500">Your personalized itinerary will appear here.</div>
                </div>
            </div>
        </div>
        
        <!-- AI RECIPES SECTION -->
        <div id="ai-recipes-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md">
                <button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200">
                    <i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i>
                </button>
                <h2 class="text-xl font-bold text-gray-800 mx-auto">AI Recipes from Kos</h2>
            </header>
            <div class="p-6 space-y-4">
                <div class="card p-4 text-center">
                    <h3 class="font-semibold text-lg mb-2">Taste the Island</h3>
                    <p class="text-gray-600 mb-4">Get a delicious recipe suggestion using fresh, local ingredients from Kos.</p>
                    <button onclick="generateRecipe()" class="w-full btn-primary">Suggest a Recipe</button>
                </div>
                <div id="recipe-output" class="prose-custom space-y-4">
                     <div class="text-center p-4 text-gray-500">Your recipe will appear here.</div>
                </div>
            </div>
        </div>

        <!-- AI REVIEW ASSISTANT (in Departure Section) -->
        <div id="departure-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md">
                <button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200">
                    <i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i>
                </button>
                <h2 class="text-xl font-bold text-gray-800 mx-auto">Until Next Time...</h2>
            </header>
            <div class="p-6 prose-custom">
                <h3 class="text-2xl font-bold mb-4">A Fond Farewell</h3>
                <p class="mb-4">As your time on the beautiful island of Kos draws to a close, we want to extend our sincerest thanks for choosing to stay with us. We truly hope you've had a wonderful and memorable holiday.</p>
                
                <div class="card my-6 bg-blue-50 p-6">
                    <h3 class="font-semibold text-lg mb-2 flex items-center"><i data-lucide="check-circle" class="w-5 h-5 mr-2 text-blue-500"></i>Check-out Reminder</h3>
                    <ul class="list-disc list-inside text-gray-600 space-y-1">
                        <li>Check-out time is by <strong>11:00 AM</strong>.</li>
                        <li>Please leave the <strong>keys in the lockbox</strong>.</li>
                        <li>Ensure all personal belongings are packed.</li>
                        <li>Turn off all lights and A/C units.</li>
                    </ul>
                </div>

                <h3 class="text-xl font-semibold mt-6 mb-2">Share Your Experience</h3>
                <p>If you enjoyed your stay, we would be incredibly grateful if you could leave a review. Your feedback helps future travellers discover our little piece of paradise.</p>
                
                <!-- AI Review Assistant -->
                <div class="card p-4 my-6 not-prose">
                     <h3 class="font-semibold text-lg mb-2 flex items-center"><i data-lucide="edit-3" class="w-5 h-5 mr-2 text-purple-500"></i>AI Review Assistant</h3>
                     <p class="text-sm text-gray-600 mb-2">Need help writing your review? Jot down a few keywords and let our AI assistant help you.</p>
                     <div>
                        <label for="review-keywords" class="block text-sm font-medium text-gray-700">Keywords about your stay:</label>
                        <textarea id="review-keywords" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2" placeholder="e.g., beautiful view, clean, great location, friendly host..."></textarea>
                    </div>
                    <button onclick="generateReview()" class="mt-4 w-full bg-purple-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-purple-600">Generate Review</button>
                    <div id="review-output" class="mt-4 space-y-2">
                        <!-- Generated review will appear here -->
                    </div>
                </div>

                <p>You can post your review on the platform you used for booking or on our <a href="https://g.page/r/CbUXM_AzUnc5EAE/review" target="_blank" class="text-blue-600 hover:underline">Google Business Profile</a>.</p>
                
                <h3 class="text-xl font-semibold mt-6 mb-2">Stay Connected</h3>
                <p>Follow us on Instagram <a href="https://www.instagram.com/diamantedelmar.phaedra" target="_blank" class="text-blue-600 hover:underline">@diamantedelmar.phaedra</a>.</p>

                <p class="mt-8">Thank you once again. We wish you a safe and pleasant journey onwards!</p>
            </div>
        </div>

        <!-- Welcome Section (Original) -->
        <div id="welcome-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md">
                <button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200">
                    <i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i>
                </button>
                <h2 class="text-xl font-bold text-gray-800 mx-auto">Welcome to Paradise!</h2>
            </header>
            <div class="p-6 prose-custom">
                <h3 class="text-2xl font-bold mb-4">Kalós órises!</h3>
                <p class="mb-4">Welcome to Kos, and welcome to Diamante del Mar Phaedra. We are absolutely delighted to host you on this enchanting Dodecanese island. Recently renovated and designed with style and comfort in mind, we hope our home serves as your perfect sanctuary to explore the captivating blend of ancient history, sun-drenched beaches, and vibrant island life that makes Kos so special.</p>
                <p class="mb-4">Kos invites you to slow down, breathe in the sea air, wander through millennia of history, and savour the simple pleasures. We hope you fall in love with its unique charm just as we have.</p>
                <h3 class="text-xl font-semibold mt-6 mb-2">About This Guide</h3>
                <p>Think of this book as your curated introduction to living like a stylish local. We've gathered essential information to help you settle in effortlessly, alongside our personal recommendations for discovering the island's highlights. Now, relax, unwind, and let your Kos story begin!</p>
            </div>
        </div>

        <!-- Essentials Section (Original) -->
        <div id="essentials-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md">
                <button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200">
                    <i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i>
                </button>
                <h2 class="text-xl font-bold text-gray-800 mx-auto">Apartment Info</h2>
            </header>
            <div class="p-6 space-y-6">
                <div class="card p-6">
                    <h3 class="font-semibold text-lg mb-2 flex items-center"><i data-lucide="map-pin" class="w-5 h-5 mr-2 text-blue-500"></i>Address</h3>
                    <p class="text-gray-600">Diamante Del Mar Phaedra</p>
                    <p class="text-gray-600">Σοφοκλή Βενιζέλου 54 (Sophokli Venizelou 54)</p>
                    <p class="text-gray-600">Kos Town, 853 00</p>
                    <a href="https://www.google.com/maps/search/?api=1&query=Diamante+Del+Mar+Phaedra,+Sophokli+Venizelou+54,+Kos+Town,+85300" target="_blank" class="inline-flex items-center mt-2 text-blue-600 font-semibold hover:underline">Open in Maps <i data-lucide="external-link" class="w-4 h-4 ml-1"></i></a>
                </div>
                <div class="card p-6">
                    <h3 class="font-semibold text-lg mb-2 flex items-center"><i data-lucide="clock" class="w-5 h-5 mr-2 text-blue-500"></i>Check-in & Out</h3>
                    <p class="text-gray-600"><strong>Check-in:</strong> After 16:00 (4:00 PM)</p>
                    <p class="text-gray-600"><strong>Lockbox Code:</strong> 1723</p>
                    <p class="text-gray-600 mt-2"><strong>Check-out:</strong> By 11:00 AM</p>
                    <p class="text-gray-500 text-sm mt-1">Please leave keys in the Lock Box.</p>
                </div>
                <div class="card p-6">
                    <h3 class="font-semibold text-lg mb-2 flex items-center"><i data-lucide="wifi" class="w-5 h-5 mr-2 text-blue-500"></i>Wi-Fi Access</h3>
                    <p class="text-gray-600"><strong>Network:</strong> Phaedra</p>
                    <div class="flex justify-between items-center mt-1">
                        <p class="text-gray-600"><strong>Password:</strong> <span id="wifi-password">Phaedra!22420@</span></p>
                        <button onclick="copyToClipboard('#wifi-password', 'Password copied!')" class="bg-blue-500 text-white px-3 py-1 rounded-lg text-sm font-semibold hover:bg-blue-600">Copy</button>
                    </div>
                </div>
                 <div class="card p-6">
                    <h3 class="font-semibold text-lg mb-2 flex items-center"><i data-lucide="home" class="w-5 h-5 mr-2 text-blue-500"></i>House Rules</h3>
                    <ul class="list-disc list-inside text-gray-600 space-y-1">
                        <li><strong>Strictly non-smoking</strong> indoors.</li>
                        <li><strong>No pets</strong> allowed.</li>
                        <li>Quiet hours: <strong>22:00 - 07:00</strong>.</li>
                        <li><strong>No parties</strong> or large gatherings.</li>
                        <li>Only registered guests may stay overnight.</li>
                    </ul>
                </div>
                 <div class="card p-6">
                    <h3 class="font-semibold text-lg mb-2 flex items-center"><i data-lucide="book-open" class="w-5 h-5 mr-2 text-blue-500"></i>Appliance Manuals</h3>
                    <p class="text-gray-600 mb-4">Scan the QR code with your phone's camera to view the manual for each appliance.</p>
                    <div class="grid grid-cols-2 gap-4 text-center">
                        <div>
                            <p class="font-medium text-gray-700">Microwave</p>
                            <a href="https://www.grundig.com/content/dam/rainbow-grundig-greece-gr-aem/rainbow-grundig-greece-gr-aemProductCatalog/product-documents/8897453600-GMI-12311-B/en-US-8897453600-20221020135181-User-Manual---File-Longsv-SE.pdf"><img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.grundig.com/content/dam/rainbow-grundig-greece-gr-aem/rainbow-grundig-greece-gr-aemProductCatalog/product-documents/8897453600-GMI-12311-B/en-US-8897453600-20221020135181-User-Manual---File-Longsv-SE.pdf" alt="QR Code for Microwave Manual" class="mx-auto mt-1 rounded-lg"></a>
                        </div>
                        <div>
                            <p class="font-medium text-gray-700">Oven</p>
                           <a href="https://www.grundig.com/content/dam/rainbow-grundig-greece-gr-aem/rainbow-grundig-greece-gr-aemProductCatalog/product-documents/7768282928-Edition-75-Backofenset/en-US-7768282928-202311021237674-User-Manual---File-Longen-US.pdf"> <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.grundig.com/content/dam/rainbow-grundig-greece-gr-aem/rainbow-grundig-greece-gr-aemProductCatalog/product-documents/7768282928-Edition-75-Backofenset/en-US-7768282928-202311021237674-User-Manual---File-Longen-US.pdf" alt="QR Code for Oven Manual" class="mx-auto mt-1 rounded-lg"></a>
                        </div>
                        <div>
                            <p class="font-medium text-gray-700">Nespresso Coffee machine</p>
                            <a href="https://www.nespresso.com/shared_res/manuals/essenza-mini/2017/UM_NESPRESSO_ESSENZA_MINI_KRUPS_PROD_WEB_2017_02_20.pdf"><img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.nespresso.com/shared_res/manuals/essenza-mini/2017/UM_NESPRESSO_ESSENZA_MINI_KRUPS_PROD_WEB_2017_02_20.pdf" alt="QR Code for Nespresso Manual" class="mx-auto mt-1 rounded-lg"></a>
                        </div>
                        <div>
                            <p class="font-medium text-gray-700">Washing Machine</p>
                            <a href="https://morris.gr/wp-content/uploads/2023/12/Instructions-manual-WIW-81411BI.pdf"><img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://morris.gr/wp-content/uploads/2023/12/Instructions-manual-WIW-81411BI.pdf" alt="QR Code for Washing Machine Manual" class="mx-auto mt-1 rounded-lg"></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Guide Section (Original) -->
        <div id="guide-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md">
                <button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200">
                    <i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i>
                </button>
                <h2 class="text-xl font-bold text-gray-800 mx-auto">Island Guide</h2>
            </header>
            <div class="p-6 space-y-8">
                <!-- Content remains the same -->
                 <div class="card overflow-hidden p-0 bg-blue-50 border border-blue-200">
                    <img src="https://images.unsplash.com/photo-1551028150-64b9f398f67b?q=80&w=800&auto=format&fit=crop" onerror="this.onerror=null;this.src='https://xasapaki.gr/wp-content/uploads/2023/05/DSC01818-scaled.jpg';" alt="A perfectly grilled steak" class="w-full h-40 object-cover">
                    <div class="p-4">
                        <h3 class="font-bold text-xl mb-2 text-blue-800 flex items-center"><i data-lucide="star" class="w-6 h-6 mr-2 text-yellow-500 fill-current"></i>Host's Top Pick: Xasapaki</h3>
                        <p class="text-blue-700 mb-3">For an unforgettable meal, visit Xasapaki. It's a unique butcher shop and steakhouse where you pick your cut of meat and they grill it to perfection. Their burgers are legendary!</p>
                        <div class="flex space-x-2">
                           <a href="https://xasapaki.gr/" target="_blank" class="inline-flex items-center bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700">Visit Website</a>
                           <a href="https://www.google.com/maps/search/?api=1&query=Xasapaki+Kos" target="_blank" class="inline-flex items-center bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-semibold hover:bg-gray-300">View on Map</a>
                        </div>
                    </div>
                </div>
                <!-- Other guide content... -->
            </div>
        </div>
        
        <!-- Other original sections (transport, important, events, local-products, island-hopping) would go here, unchanged -->
        <!-- For brevity, I'm omitting the full original sections but they should be present in the final file -->
        <div id="transport-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md"><button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200"><i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i></button><h2 class="text-xl font-bold text-gray-800 mx-auto">Getting Around Kos</h2></header>
            <div class="p-6 space-y-6"><!-- content --></div>
        </div>
        <div id="important-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md"><button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200"><i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i></button><h2 class="text-xl font-bold text-gray-800 mx-auto">Important Info</h2></header>
            <div class="p-6 space-y-6"><!-- content --></div>
        </div>
        <div id="events-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md"><button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200"><i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i></button><h2 class="text-xl font-bold text-gray-800 mx-auto">HIPPOCRATEIA 2025</h2></header>
            <div class="p-6"><!-- content --></div>
        </div>
        <div id="local-products-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md"><button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200"><i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i></button><h2 class="text-xl font-bold text-gray-800 mx-auto">Local Products of Kos</h2></header>
            <div class="p-6 space-y-8"><!-- content --></div>
        </div>
        <div id="island-hopping-section" class="section-screen">
            <header class="section-header p-4 flex items-center shadow-md"><button onclick="goBack()" class="p-2 rounded-full hover:bg-gray-200"><i data-lucide="arrow-left" class="w-6 h-6 text-gray-700"></i></button><h2 class="text-xl font-bold text-gray-800 mx-auto">Island Hopping from Kos</h2></header>
            <div class="p-6 space-y-8"><!-- content --></div>
        </div>


    </div>

    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg opacity-0 transition-opacity duration-300">
        Message copied!
    </div>

    <script>
        // --- CONFIGURATION ---
        const API_KEY = "AIzaSyDd1fUY4syyAvclAWcVo0mr8nsnvbAZLQ4";
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`;
        
        // --- UI & NAVIGATION ---
        lucide.createIcons();
        let currentSection = null;
        const homeScreen = document.getElementById('home-screen');

        function showSection(sectionId) {
            homeScreen.style.display = 'none';
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
                currentSection = section;
                section.scrollTop = 0;
            }
        }

        function goBack() {
            if (currentSection) {
                currentSection.classList.remove('active');
                currentSection = null;
            }
            setTimeout(() => {
                 homeScreen.style.display = 'block';
            }, 300);
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.innerText = message;
            toast.style.opacity = '1';
            setTimeout(() => {
                toast.style.opacity = '0';
            }, 2000);
        }

        function copyToClipboard(elementSelector, toastMessage) {
            const textToCopy = document.querySelector(elementSelector).innerText;
            const textArea = document.createElement('textarea');
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showToast(toastMessage);
            } catch (err) {
                console.error('Failed to copy text: ', err);
                showToast('Failed to copy!');
            }
            document.body.removeChild(textArea);
        }
        
        function copyGeneratedText(text, toastMessage) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showToast(toastMessage);
            } catch (err) {
                console.error('Failed to copy text: ', err);
                showToast('Failed to copy!');
            }
            document.body.removeChild(textArea);
        }

        // --- GEMINI API HANDLER ---
        async function callGeminiAPI(prompt) {
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }]
                    })
                });

                if (!response.ok) {
                    const errorBody = await response.json();
                    console.error("API Error:", errorBody);
                    return `Error: ${errorBody.error.message}`;
                }

                const data = await response.json();
                 if (data.candidates && data.candidates.length > 0) {
                    return data.candidates[0].content.parts[0].text;
                } else {
                    return "Sorry, I couldn't generate a response. The API returned an unexpected result.";
                }
            } catch (error) {
                console.error("Fetch Error:", error);
                return "Error: Could not connect to the AI service. Please check your network connection.";
            }
        }

        function showLoading(containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = `<div class="flex justify-center items-center p-8"><div class="loader"></div></div>`;
        }

        // --- AI FEATURES ---

        // 1. AI CONCIERGE
        const chatContainer = document.getElementById('chat-container');
        const chatInput = document.getElementById('chat-input');
        
        function getWelcomeBookContext() {
            const sectionsToScan = ['welcome-section', 'essentials-section', 'guide-section', 'transport-section', 'important-section', 'departure-section', 'local-products-section', 'island-hopping-section'];
            let context = "Welcome Book Information:\n";
            sectionsToScan.forEach(id => {
                const section = document.getElementById(id);
                if (section) {
                    context += `\n--- Section: ${id.replace('-section','')} ---\n`;
                    context += section.innerText || section.textContent;
                }
            });
            return context;
        }

        async function handleChatSubmit() {
            const userMessage = chatInput.value.trim();
            if (!userMessage) return;

            // Display user message
            chatContainer.innerHTML += `<div class="chat-bubble user">${userMessage}</div>`;
            chatInput.value = '';
            chatContainer.scrollTop = chatContainer.scrollHeight;

            // Show loading indicator
            chatContainer.innerHTML += `<div id="ai-loading" class="chat-bubble ai"><div class="loader" style="width:24px; height:24px; border-bottom-color: #4a90e2;"></div></div>`;
            chatContainer.scrollTop = chatContainer.scrollHeight;

            const knowledgeSource = document.querySelector('input[name="knowledgeSource"]:checked').value;
            let prompt;

            if (knowledgeSource === 'welcomeBook') {
                const context = getWelcomeBookContext();
                prompt = `You are a helpful AI concierge for the 'Diamante del Mar Phaedra' apartment in Kos, Greece. Based *only* on the provided "Welcome Book Information" below, answer the user's question. If the answer is not in the text, say "I'm sorry, that information is not in the welcome book." Do not use any external knowledge.\n\n${context}\n\nUser Question: "${userMessage}"`;
            } else {
                prompt = `You are a helpful AI concierge for a tourist in Kos, Greece. Answer the following question: "${userMessage}"`;
            }

            const aiResponse = await callGeminiAPI(prompt);
            
            // Replace loading with AI response
            const loadingBubble = document.getElementById('ai-loading');
            loadingBubble.innerHTML = aiResponse.replace(/\n/g, '<br>'); // Basic formatting
            loadingBubble.removeAttribute('id');
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
        
        chatInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                handleChatSubmit();
            }
        });

        // 2. AI RECIPES
        async function generateRecipe() {
            const outputContainer = document.getElementById('recipe-output');
            showLoading('recipe-output');
            const prompt = "You are a creative chef specializing in Greek island cuisine. Suggest a simple and delicious recipe using one or more of these local products from Kos, Greece: Posa cheese (wine cheese), Kos thyme honey, local olive oil, fresh fish (like sea bream or sea bass), and cherry tomatoes. Provide a catchy name for the recipe, a short description, the list of ingredients, and step-by-step instructions. Format the response nicely with headings.";
            const response = await callGeminiAPI(prompt);
            outputContainer.innerHTML = response.replace(/\n/g, '<br>');
        }

        // 3. AI ITINERARY
        async function generateItinerary() {
            const outputContainer = document.getElementById('itinerary-output');
            const days = document.getElementById('stay-days').value;
            const interests = document.getElementById('interests').value;

            if (!days || !interests) {
                outputContainer.innerHTML = `<div class="text-center p-4 text-red-500">Please enter the number of days and your interests.</div>`;
                return;
            }
            
            showLoading('itinerary-output');
            const guideContext = document.getElementById('guide-section').innerText;
            const prompt = `You are an expert tour guide for Kos, Greece. Create a personalized, day-by-day itinerary for a ${days}-day trip for a tourist whose interests are: "${interests}". Use the host's recommendations from the guide below as a priority. For each day, suggest a morning activity, an afternoon activity, and a dinner suggestion. Be creative and practical.\n\nHost's Guide:\n${guideContext}`;
            
            const response = await callGeminiAPI(prompt);
            outputContainer.innerHTML = response.replace(/\n/g, '<br>');
        }

        // 4. AI REVIEW ASSISTANT
        async function generateReview() {
            const outputContainer = document.getElementById('review-output');
            const keywords = document.getElementById('review-keywords').value;
            
            if (!keywords) {
                outputContainer.innerHTML = `<p class="text-red-500 text-sm">Please enter at least one keyword.</p>`;
                return;
            }

            outputContainer.innerHTML = `<div class="flex justify-center items-center p-4"><div class="loader"></div></div>`;
            
            const prompt = `You are a helpful assistant for a hotel guest. Based on these keywords: "${keywords}", write a friendly and positive review for a vacation rental. Make it sound natural and personal. The property is called 'Diamante del Mar Phaedra'. The review should be about 3-5 sentences long.`;

            const response = await callGeminiAPI(prompt);
            
            const reviewText = response; // The raw text response
            
            outputContainer.innerHTML = `
                <textarea id="generated-review-text" rows="5" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2">${reviewText}</textarea>
                <button onclick="copyGeneratedText(document.getElementById('generated-review-text').value, 'Review copied!')" class="mt-2 w-full bg-gray-500 text-white px-3 py-1 rounded-lg text-sm font-semibold hover:bg-gray-600">Copy Review</button>
            `;
        }

    </script>
</body>
</html>
